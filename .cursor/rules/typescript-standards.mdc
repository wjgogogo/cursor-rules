---
description: 
globs: *.ts,*.tsx
alwaysApply: false
---
# TypeScript è§„èŒƒ

## æ ¸å¿ƒåŸåˆ™ [P0]

ã€å¿…é¡»ã€‘ç¡®ä¿ä»£ç è´¨é‡ï¼š
- **ç±»å‹å®‰å…¨**ï¼šæ‰€æœ‰å˜é‡ã€å‡½æ•°å‚æ•°å’Œè¿”å›å€¼å¿…é¡»å®šä¹‰ç±»å‹
- **ä¼˜å…ˆä½¿ç”¨ `interface`** å®šä¹‰å¯¹è±¡ç»“æ„
- **ç¦æ­¢ä½¿ç”¨ `enum`**ï¼Œä½¿ç”¨è”åˆç±»å‹æ›¿ä»£
- **é¿å… `any`**ï¼Œä½¿ç”¨ `unknown` + ç±»å‹å®ˆå«

## åŸºç¡€ç±»å‹å®šä¹‰ [P0]

ã€å¿…é¡»ã€‘æ­£ç¡®å®šä¹‰ç±»å‹ï¼š

```tsx
// âœ… æ­£ç¡® - åŸºç¡€ç±»å‹å®šä¹‰
interface User {
  id: string;
  name: string;
  email: string;
  role: 'admin' | 'user' | 'guest';
}

// âœ… æ­£ç¡® - ç»„ä»¶ Props
interface UserCardProps {
  user: User;
  onEdit?: (user: User) => void;
  className?: string;
}

export function UserCard({ user, onEdit, className }: UserCardProps) {
  return (
    <div className={className}>
      <h3>{user.name}</h3>
      <p>{user.email}</p>
      {onEdit && (
        <button onClick={() => onEdit(user)}>ç¼–è¾‘</button>
      )}
    </div>
  );
}

// âŒ é”™è¯¯ - ç¼ºå°‘ç±»å‹å®šä¹‰
function UserCard(props) {
  return <div>{props.user.name}</div>;
}
```

## è”åˆç±»å‹æ›¿ä»£ enum [P0]

ã€å¿…é¡»ã€‘ä½¿ç”¨è”åˆç±»å‹ï¼š

```tsx
// âœ… æ­£ç¡® - è”åˆç±»å‹
type UserRole = 'admin' | 'user' | 'guest';
type Theme = 'light' | 'dark' | 'auto';
type Status = 'pending' | 'loading' | 'success' | 'error';

// âœ… æ­£ç¡® - åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
interface ButtonProps {
  variant: 'primary' | 'secondary' | 'danger';
  size: 'small' | 'medium' | 'large';
  children: React.ReactNode;
}

// âŒ é”™è¯¯ - ä½¿ç”¨ enum
enum UserRole {
  Admin = 'admin',
  User = 'user',
}
```

## åŸºç¡€å·¥å…·ç±»å‹ [P0]

ã€å¿…é¡»ã€‘æŒæ¡å¸¸ç”¨å·¥å…·ç±»å‹ï¼š

```tsx
// âœ… æ­£ç¡® - Partial å’Œ Omit
type CreateUserRequest = Omit<User, 'id'>; // åˆ›å»ºæ—¶ä¸éœ€è¦ id
type UpdateUserRequest = Partial<Pick<User, 'name' | 'email'>>; // æ›´æ–°æ—¶å¯é€‰

// âœ… æ­£ç¡® - API å“åº”ç±»å‹
interface ApiResponse<T> {
  data: T;
  status: number;
  message: string;
}

// âœ… æ­£ç¡® - å‡½æ•°ç±»å‹
async function updateUser(
  id: string, 
  params: UpdateUserRequest
): Promise<ApiResponse<User>> {
  const response = await fetch(`/api/users/${id}`, {
    method: 'PUT',
    body: JSON.stringify(params),
  });
  return response.json();
}
```

## ç±»å‹å®ˆå« [P0]

ã€å¿…é¡»ã€‘å®‰å…¨å¤„ç†æœªçŸ¥ç±»å‹ï¼š

```tsx
// âœ… æ­£ç¡® - åŸºç¡€ç±»å‹å®ˆå«
function isString(value: unknown): value is string {
  return typeof value === 'string';
}

function isUser(value: unknown): value is User {
  return (
    typeof value === 'object' &&
    value !== null &&
    'id' in value &&
    'name' in value &&
    'email' in value
  );
}

// âœ… æ­£ç¡® - å®‰å…¨çš„ API å¤„ç†
async function fetchUser(id: string): Promise<User> {
  const response = await fetch(`/api/users/${id}`);
  const data: unknown = await response.json();
  
  if (isUser(data)) {
    return data;
  }
  
  throw new Error('Invalid user data');
}

// âŒ é”™è¯¯ - ä½¿ç”¨ any
function processData(data: any) {
  return data.someProperty; // ç±»å‹ä¸å®‰å…¨
}

// âŒ é”™è¯¯ - å±é™©çš„éç©ºæ–­è¨€
function getUser(id: string) {
  return users.find(u => u.id === id)!; // å¯èƒ½æŠ›å‡ºé”™è¯¯
}
```

## tsconfig.json é…ç½® [P0]

ã€å¿…é¡»ã€‘ä½¿ç”¨ä¸¥æ ¼é…ç½®ï¼š

```json
{
  "compilerOptions": {
    // åŸºç¡€é…ç½®
    "target": "ES2022",
    "lib": ["DOM", "DOM.Iterable", "ES2022"],
    "allowJs": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",

    // ä¸¥æ ¼ç±»å‹æ£€æŸ¥
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,

    // è·¯å¾„æ˜ å°„
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"],
      "@/components/*": ["./src/components/*"],
      "@/hooks/*": ["./src/hooks/*"],
      "@/utils/*": ["./src/utils/*"],
      "@/types/*": ["./src/types/*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "build"]
}
```

## ç±»å‹å¯¼å…¥å¯¼å‡º [P0]

ã€å¿…é¡»ã€‘æ­£ç¡®å¯¼å‡ºå’Œå¯¼å…¥ç±»å‹ï¼š

```tsx
// types/user.ts
export interface User {
  id: string;
  name: string;
  email: string;
}

export type UserRole = 'admin' | 'user' | 'guest';

// components/UserCard.tsx
import type { User } from '@/types/user';

interface UserCardProps {
  user: User;
  onUpdate?: (user: User) => void;
}

export function UserCard({ user, onUpdate }: UserCardProps) {
  // ç»„ä»¶å®ç°
}

// services/userService.ts
import type { User } from '@/types/user';

export async function fetchUser(id: string): Promise<User> {
  // API è°ƒç”¨å®ç°
}
```

## React Hook ç±»å‹ [P0]

ã€å¿…é¡»ã€‘æ­£ç¡®å®šä¹‰ Hook ç±»å‹ï¼š

```tsx
// âœ… æ­£ç¡® - useState ç±»å‹
const [user, setUser] = useState<User | null>(null);
const [loading, setLoading] = useState<boolean>(false);
const [users, setUsers] = useState<User[]>([]);

// âœ… æ­£ç¡® - useEffect ä¾èµ–
useEffect(() => {
  fetchUser(userId).then(setUser);
}, [userId]); // æ˜ç¡®ä¾èµ–

// âœ… æ­£ç¡® - è‡ªå®šä¹‰ Hook
function useLocalStorage<T>(key: string, initialValue: T) {
  const [value, setValue] = useState<T>(() => {
    const stored = localStorage.getItem(key);
    return stored ? JSON.parse(stored) : initialValue;
  });

  const setStoredValue = (newValue: T) => {
    setValue(newValue);
    localStorage.setItem(key, JSON.stringify(newValue));
  };

  return [value, setStoredValue] as const;
}

// ä½¿ç”¨ç¤ºä¾‹
const [theme, setTheme] = useLocalStorage<Theme>('theme', 'light');
```

## ğŸ” æ£€æŸ¥æ¸…å•

åœ¨ç¼–å†™ TypeScript ä»£ç æ—¶ï¼Œã€å¿…é¡»ã€‘ç¡®è®¤ï¼š

### æ ¸å¿ƒè¦æ±‚ [P0]
- [ ] **[P0]** ä¸¥æ ¼æ¨¡å¼ï¼š`tsconfig.json` ä¸­æ˜¯å¦å¯ç”¨äº† `"strict": true`ï¼Ÿ
- [ ] **[P0]** ç±»å‹å®šä¹‰ï¼šæ‰€æœ‰å˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›å€¼æ˜¯å¦éƒ½æœ‰ç±»å‹å®šä¹‰ï¼Ÿ
- [ ] **[P0]** interface ä¼˜å…ˆï¼šæ˜¯å¦ä¼˜å…ˆä½¿ç”¨ `interface` å®šä¹‰å¯¹è±¡ç»“æ„ï¼Ÿ
- [ ] **[P0]** é¿å… enumï¼šæ˜¯å¦ä½¿ç”¨è”åˆç±»å‹æ›¿ä»£ `enum`ï¼Ÿ
- [ ] **[P0]** é¿å… anyï¼šæ˜¯å¦é¿å…ä½¿ç”¨ `any`ï¼Œä½¿ç”¨ `unknown` + ç±»å‹å®ˆå«ï¼Ÿ
- [ ] **[P0]** ç±»å‹å®ˆå«ï¼šå¤„ç†æœªçŸ¥ç±»å‹æ—¶æ˜¯å¦ä½¿ç”¨äº†ç±»å‹å®ˆå«ï¼Ÿ
- [ ] **[P0]** å·¥å…·ç±»å‹ï¼šæ˜¯å¦åˆç†ä½¿ç”¨ `Partial`, `Omit`, `Pick` ç­‰å·¥å…·ç±»å‹ï¼Ÿ
- [ ] **[P0]** React ç±»å‹ï¼šç»„ä»¶ Props å’Œ Hook æ˜¯å¦æœ‰æ­£ç¡®çš„ç±»å‹å®šä¹‰ï¼Ÿ

### æ¨èå®è·µ [P1]
- [ ] **[P1]** è·¯å¾„åˆ«åï¼šæ˜¯å¦é…ç½®å¹¶ä½¿ç”¨äº†è·¯å¾„åˆ«å (`@/*`)ï¼Ÿ
- [ ] **[P1]** ç±»å‹å¯¼å…¥ï¼šæ˜¯å¦ä½¿ç”¨ `import type` å¯¼å…¥ç±»å‹ï¼Ÿ
- [ ] **[P1]** æ³›å‹ä½¿ç”¨ï¼šæ˜¯å¦åœ¨é€‚å½“åœºæ™¯ä½¿ç”¨äº†æ³›å‹ï¼Ÿ
