---
description: 
globs: *.js,*.jsx,*.ts,*.tsx
alwaysApply: false
---
# React å¼€å‘è§„èŒƒ

> **ç±»å‹å®šä¹‰è§„èŒƒ**ï¼šè¯¦ç»†çš„ TypeScript ç±»å‹è§„èŒƒè¯·å‚è€ƒ `typescript-standards.mdc`

## æ ¸å¿ƒåŸåˆ™ [P0]

ã€å¿…é¡»ã€‘éµå¾ªï¼š
- ä½¿ç”¨å‡½æ•°ç»„ä»¶ + Hooksï¼Œé¿å…ç±»ç»„ä»¶
- TypeScript å®šä¹‰æ‰€æœ‰ Props ç±»å‹
- å‘½åå¯¼å‡ºï¼Œé¿å…é»˜è®¤å¯¼å‡º
- è‡ªå®šä¹‰ Hooks ä»¥ `use` å¼€å¤´

## ç»„ä»¶å®šä¹‰

ã€å¿…é¡»ã€‘ä½¿ç”¨ TypeScript å®šä¹‰ç»„ä»¶ï¼š

```tsx
// âœ… æ­£ç¡® - å‡½æ•°ç»„ä»¶ + TypeScript
interface ButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  variant?: 'primary' | 'secondary';
  disabled?: boolean;
}

export function Button({ 
  children, 
  onClick, 
  variant = 'primary',
  disabled = false 
}: ButtonProps) {
  return (
    <button 
      className={`btn btn-${variant}`}
      onClick={onClick}
      disabled={disabled}
    >
      {children}
    </button>
  );
}

// âŒ é”™è¯¯ - é»˜è®¤å¯¼å‡º + æ— ç±»å‹
export default function Button(props) {
  return <button>{props.children}</button>;
}
```

## Hooks ä½¿ç”¨è§„èŒƒ

ã€å¿…é¡»ã€‘æ­£ç¡®ä½¿ç”¨ Hooksï¼š

```tsx
// âœ… æ­£ç¡® - è‡ªå®šä¹‰ Hook
function useLocalStorage<T>(key: string, initialValue: T) {
  const [value, setValue] = useState<T>(() => {
    const stored = localStorage.getItem(key);
    return stored ? JSON.parse(stored) : initialValue;
  });

  const setStoredValue = (newValue: T) => {
    setValue(newValue);
    localStorage.setItem(key, JSON.stringify(newValue));
  };

  return [value, setStoredValue] as const;
}

// âœ… æ­£ç¡® - å‰¯ä½œç”¨æ¸…ç†
function useEventListener(event: string, handler: (e: Event) => void) {
  useEffect(() => {
    window.addEventListener(event, handler);
    return () => window.removeEventListener(event, handler);
  }, [event, handler]);
}

// âŒ é”™è¯¯ - æ¡ä»¶ Hook
function BadComponent({ condition }: { condition: boolean }) {
  if (condition) {
    const [state, setState] = useState(0); // è¿å Hook è§„åˆ™
  }
  return <div>Content</div>;
}
```

## çŠ¶æ€ç®¡ç†

ã€å¿…é¡»ã€‘åˆç†ç®¡ç†çŠ¶æ€ï¼š

```tsx
// âœ… æ­£ç¡® - çŠ¶æ€æå‡
interface TodoListProps {
  todos: Todo[];
  onToggle: (id: string) => void;
  onDelete: (id: string) => void;
}

export function TodoList({ todos, onToggle, onDelete }: TodoListProps) {
  return (
    <div>
      {todos.map(todo => (
        <TodoItem 
          key={todo.id}
          todo={todo}
          onToggle={onToggle}
          onDelete={onDelete}
        />
      ))}
    </div>
  );
}

// âœ… æ­£ç¡® - å¤æ‚çŠ¶æ€ä½¿ç”¨ useReducer
interface State {
  loading: boolean;
  data: User[];
  error: string | null;
}

type Action = 
  | { type: 'FETCH_START' }
  | { type: 'FETCH_SUCCESS'; payload: User[] }
  | { type: 'FETCH_ERROR'; payload: string };

function userReducer(state: State, action: Action): State {
  switch (action.type) {
    case 'FETCH_START':
      return { ...state, loading: true, error: null };
    case 'FETCH_SUCCESS':
      return { ...state, loading: false, data: action.payload };
    case 'FETCH_ERROR':
      return { ...state, loading: false, error: action.payload };
    default:
      return state;
  }
}

function useUsers() {
  const [state, dispatch] = useReducer(userReducer, {
    loading: false,
    data: [],
    error: null,
  });

  return { state, dispatch };
}
```

## äº‹ä»¶å¤„ç†

ã€å¿…é¡»ã€‘æ­£ç¡®å¤„ç†äº‹ä»¶ï¼š

```tsx
// âœ… æ­£ç¡® - äº‹ä»¶å¤„ç†
interface FormProps {
  onSubmit: (data: FormData) => void;
}

export function ContactForm({ onSubmit }: FormProps) {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    message: '',
  });

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    onSubmit(formData);
  };

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const { name, value } = e.target;
    setFormData(prev => ({ ...prev, [name]: value }));
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        name="name"
        value={formData.name}
        onChange={handleInputChange}
        placeholder="å§“å"
      />
      <input
        name="email"
        value={formData.email}
        onChange={handleInputChange}
        placeholder="é‚®ç®±"
      />
      <button type="submit">æäº¤</button>
    </form>
  );
}
```

## æ¡ä»¶æ¸²æŸ“

ã€å¿…é¡»ã€‘æ¸…æ™°çš„æ¡ä»¶æ¸²æŸ“ï¼š

```tsx
// âœ… æ­£ç¡® - æ¸…æ™°çš„æ¡ä»¶æ¸²æŸ“
function UserProfile({ user, isLoading, error }: UserProfileProps) {
  if (isLoading) {
    return <div>åŠ è½½ä¸­...</div>;
  }

  if (error) {
    return <div>é”™è¯¯: {error}</div>;
  }

  if (!user) {
    return <div>æœªæ‰¾åˆ°ç”¨æˆ·</div>;
  }

  return (
    <div>
      <h1>{user.name}</h1>
      <p>{user.email}</p>
      {user.isAdmin && <div>ç®¡ç†å‘˜</div>}
    </div>
  );
}

// âœ… æ­£ç¡® - åˆ—è¡¨æ¸²æŸ“
function ProductList({ products }: { products: Product[] }) {
  if (products.length === 0) {
    return <div>æš‚æ— äº§å“</div>;
  }

  return (
    <div>
      {products.map(product => (
        <ProductCard key={product.id} product={product} />
      ))}
    </div>
  );
}
```

## æ€§èƒ½ä¼˜åŒ–

ã€æ¨èã€‘é€‚å½“ä½¿ç”¨ä¼˜åŒ–æŠ€æœ¯ï¼š

```tsx
// âœ… æ­£ç¡® - React.memo
const ExpensiveComponent = React.memo(function ExpensiveComponent({ 
  data, 
  onUpdate 
}: ExpensiveComponentProps) {
  return (
    <div>
      {/* å¤æ‚æ¸²æŸ“é€»è¾‘ */}
    </div>
  );
});

// âœ… æ­£ç¡® - useMemo ç¼“å­˜è®¡ç®—
function ProductList({ products, filter }: ProductListProps) {
  const filteredProducts = useMemo(() => {
    return products.filter(product => 
      product.name.toLowerCase().includes(filter.toLowerCase())
    );
  }, [products, filter]);

  return (
    <div>
      {filteredProducts.map(product => (
        <ProductCard key={product.id} product={product} />
      ))}
    </div>
  );
}

// âœ… æ­£ç¡® - useCallback ç¼“å­˜å‡½æ•°
function TodoApp() {
  const [todos, setTodos] = useState<Todo[]>([]);

  const handleToggle = useCallback((id: string) => {
    setTodos(prev => prev.map(todo => 
      todo.id === id ? { ...todo, completed: !todo.completed } : todo
    ));
  }, []);

  return <TodoList todos={todos} onToggle={handleToggle} />;
}
```

## React é”™è¯¯è¾¹ç•Œ

ã€å¿…é¡»ã€‘åœ¨å…³é”®ç»„ä»¶æ·»åŠ é”™è¯¯è¾¹ç•Œï¼š

```tsx
function ErrorBoundary({ children, fallback }: {
  children: React.ReactNode;
  fallback?: React.ComponentType<{ error: Error; retry: () => void }>;
}) {
  const [error, setError] = useState<Error | null>(null);

  if (error) {
    const FallbackComponent = fallback || DefaultErrorFallback;
    return <FallbackComponent error={error} retry={() => setError(null)} />;
  }

  return (
    <ErrorBoundaryProvider onError={setError}>
      {children}
    </ErrorBoundaryProvider>
  );
}
```

## ğŸ” æ£€æŸ¥æ¸…å•

åœ¨å¼€å‘å’Œå®¡æŸ¥ React ç»„ä»¶åŠç›¸å…³é€»è¾‘æ—¶ï¼Œè¯·å¯¹ç…§ä»¥ä¸‹æ£€æŸ¥é¡¹ï¼š

### æ ¸å¿ƒè¦æ±‚ & ç»„ä»¶å®šä¹‰ [P0]
- [ ] **[P0]** å‡½æ•°ç»„ä»¶ä¸ Hooksï¼šæ˜¯å¦æ‰€æœ‰æ–°ç»„ä»¶éƒ½ä½¿ç”¨å‡½æ•°ç»„ä»¶å’Œ Hooks å®ç°ï¼Œé¿å…äº†ç±»ç»„ä»¶ï¼Ÿ
- [ ] **[P0]** TypeScript ç±»å‹å®šä¹‰ï¼šç»„ä»¶çš„æ‰€æœ‰ Props å’Œå†…éƒ¨ State æ˜¯å¦éƒ½æœ‰æ˜ç¡®çš„ TypeScript ç±»å‹å®šä¹‰ï¼Ÿï¼ˆè¯¦ç»†è§„èŒƒå‚è€ƒ `typescript-standards.mdc`ï¼‰
- [ ] **[P0]** Props é»˜è®¤å€¼ä¸è§£æ„ï¼šProps æ˜¯å¦æ¸…æ™°è§£æ„ï¼Œå¹¶ä¸ºå¯é€‰ Props æä¾›äº†åˆç†çš„é»˜è®¤å€¼ï¼Ÿ
- [ ] **[P0]** å‘½åå¯¼å‡ºï¼šç»„ä»¶æ˜¯å¦ä½¿ç”¨å‘½åå¯¼å‡º (`export function MyComponent`)ï¼Œé¿å…äº†é»˜è®¤å¯¼å‡ºï¼Ÿï¼ˆå‚è€ƒ `module-exports.mdc`ï¼‰
- [ ] **[P0]** Hooks ä½¿ç”¨è§„åˆ™ï¼š
    - æ˜¯å¦ä»…åœ¨ React å‡½æ•°ç»„ä»¶çš„é¡¶å±‚æˆ–è‡ªå®šä¹‰ Hooks ä¸­è°ƒç”¨ Hooksï¼Ÿ
    - æ˜¯å¦é¿å…äº†åœ¨å¾ªç¯ã€æ¡ä»¶è¯­å¥æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hooksï¼Ÿ
    - å¯¹äº `useEffect` ç­‰ä¼šäº§ç”Ÿå‰¯ä½œç”¨çš„ Hooksï¼Œæ˜¯å¦æ­£ç¡®å¤„ç†äº†ä¾èµ–é¡¹æ•°ç»„ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿”å›äº†æ¸…ç†å‡½æ•°ï¼Ÿ
- [ ] **[P0]** è‡ªå®šä¹‰ Hooks å‘½åï¼šæ‰€æœ‰è‡ªå®šä¹‰ Hooks çš„åç§°æ˜¯å¦éƒ½ä»¥ `use` å¼€å¤´ (å¦‚ `useLocalStorage`)ï¼Ÿ
- [ ] **[P0]** äº‹ä»¶å¤„ç†è§„èŒƒï¼šäº‹ä»¶å¤„ç†å‡½æ•°ï¼ˆå¦‚ `handleSubmit`, `handleInputChange`ï¼‰æ˜¯å¦æ­£ç¡®ç»‘å®šï¼Œå¹¶ä½¿ç”¨äº†æ­£ç¡®çš„äº‹ä»¶ç±»å‹ (å¦‚ `React.FormEvent`, `React.ChangeEvent`)ï¼Ÿ
- [ ] **[P0]** æ¡ä»¶æ¸²æŸ“æ¸…æ™°æ€§ï¼šç»„ä»¶å†…çš„æ¡ä»¶æ¸²æŸ“é€»è¾‘æ˜¯å¦æ¸…æ™°æ˜“æ‡‚ï¼Œé¿å…äº†è¿‡äºå¤æ‚çš„ JSX è¡¨è¾¾å¼ï¼Ÿï¼ˆå¦‚ä½¿ç”¨æ—©æœŸè¿”å›ã€å˜é‡èµ‹å€¼æˆ–å°è£…ç»„ä»¶ï¼‰
- [ ] **[P0]** åˆ—è¡¨æ¸²æŸ“ä¸ Keysï¼šæ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œæ˜¯å¦ä¸ºæ¯ä¸ªåˆ—è¡¨é¡¹æä¾›äº†ç¨³å®šä¸”å”¯ä¸€çš„ `key` å±æ€§ï¼Ÿ

### çŠ¶æ€ç®¡ç†ä¸ä»£ç è´¨é‡ [P1]
- [ ] **[P1]** çŠ¶æ€ç®¡ç†ç­–ç•¥ï¼šæ˜¯å¦æ ¹æ®çŠ¶æ€çš„å¤æ‚æ€§å’Œä½œç”¨åŸŸé€‰æ‹©äº†åˆé€‚çš„çŠ¶æ€ç®¡ç†æ–¹æ³•ï¼ˆå¦‚å±€éƒ¨ stateã€çŠ¶æ€æå‡ã€`useReducer`ã€Context API æˆ– Zustand ç­‰å¤–éƒ¨åº“ï¼‰ï¼Ÿ
- [ ] **[P1]** é€»è¾‘å¤ç”¨ (è‡ªå®šä¹‰ Hooks)ï¼šå¯¹äºç»„ä»¶é—´çš„å¯å¤ç”¨é€»è¾‘ï¼ˆå¦‚æœ‰å‰¯ä½œç”¨çš„é€»è¾‘ã€å¤æ‚çŠ¶æ€é€»è¾‘ï¼‰ï¼Œæ˜¯å¦å°è£…æˆäº†è‡ªå®šä¹‰ Hooksï¼Ÿ
- [ ] **[P1]** Context API ä½¿ç”¨ï¼šä½¿ç”¨ Context API æ—¶ï¼Œæ˜¯å¦æ³¨æ„äº†å…¶å¯èƒ½å¼•èµ·çš„é‡æ¸²æŸ“é—®é¢˜ï¼Œå¹¶è€ƒè™‘äº†ä¼˜åŒ–æ‰‹æ®µï¼ˆå¦‚æ‹†åˆ† Contextã€ä½¿ç”¨ `useMemo`ï¼‰ï¼Ÿ
- [ ] **[P1]** JSX ä»£ç é£æ ¼ï¼šJSX çš„ä¹¦å†™æ˜¯å¦éµå¾ªäº†è‰¯å¥½çš„é£æ ¼ï¼ˆå¦‚å¤šå±æ€§æ¢è¡Œã€boolean å±æ€§ç®€å†™ã€åˆç†çš„åµŒå¥—å’Œç¼©è¿›ï¼‰ï¼Ÿ
- [ ] **[P1]** ä¸å¯å˜æ€§ï¼šåœ¨æ›´æ–° stateï¼ˆç‰¹åˆ«æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼‰æ—¶ï¼Œæ˜¯å¦éµå¾ªäº†ä¸å¯å˜æ€§åŸåˆ™ï¼Œåˆ›å»ºäº†æ–°çš„å¯¹è±¡/æ•°ç»„å‰¯æœ¬è€Œéç›´æ¥ä¿®æ”¹åŸçŠ¶æ€ï¼Ÿ

### é«˜çº§æ¨¡å¼ä¸æ€§èƒ½ [P2]
- [ ] **[P2]** é«˜é˜¶ç»„ä»¶ (HOC) / Render Propsï¼šæ˜¯å¦ç†è§£å¹¶ä»…åœ¨åˆé€‚åœºæ™¯ä¸‹ï¼ˆå¦‚éœ€æ¨ªåˆ‡å…³æ³¨ç‚¹é€»è¾‘å¤ç”¨ä¸”è‡ªå®šä¹‰ Hook ä¸é€‚ç”¨æ—¶ï¼‰ä½¿ç”¨ HOC æˆ– Render Props æ¨¡å¼ï¼Ÿ
- [ ] **[P2]** æ€§èƒ½ä¼˜åŒ–åº”ç”¨ï¼šæ˜¯å¦ç»“åˆ `performance-optimization.mdc` ä¸­çš„è§„èŒƒï¼Œå¯¹ç»„ä»¶è¿›è¡Œäº†å¿…è¦çš„æ€§èƒ½ä¼˜åŒ–ï¼ˆå¦‚ `React.memo`, `useMemo`, `useCallback`, è™šæ‹Ÿåˆ—è¡¨ç­‰ï¼‰ï¼Ÿ
- [ ] **[P2]** é”™è¯¯è¾¹ç•Œï¼šå¯¹äºå¯èƒ½æŠ›å‡ºé”™è¯¯çš„ç»„ä»¶å­æ ‘ï¼Œæ˜¯å¦ä½¿ç”¨äº†é”™è¯¯è¾¹ç•Œï¼ˆError Boundariesï¼‰ç»„ä»¶æ¥æ•è·é”™è¯¯å¹¶å±•ç¤ºå¤‡ç”¨ UIï¼Ÿ
